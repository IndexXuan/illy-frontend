var getCurrentState=function(){var state1=mmState.currentState.stateName.split(".")[1],state2=mmState.currentState.stateName.split(".")[2];return void 0===state2?state1:state2};root.$watch("currentAction",function(currentAction){"onLoad"===currentAction&&(root.currentState=getCurrentState())});var doIsVisitedCheck=function(cacheContainer,callback){"function"==typeof cacheContainer&&(callback=cacheContainer,cacheContainer=void 0);var pageId=location.href.split("!")[1];cacheContainer=cacheContainer||CACHE_VISITED_PAGEID_CONTAINER,cacheContainer.push(pageId);for(var isVisited=!1,i=0,len=cacheContainer.length-1;len>i;i++)if(cacheContainer[i]===pageId){isVisited=!0;break}return callback&&"function"==typeof callback&&callback(),isVisited},CACHE_VISITED_PAGEID_CONTAINER=[];root.$watch("currentAction",function(currentAction){"onBegin"===currentAction&&(root.currentIsVisited=doIsVisitedCheck())});var loadingBeginHandler=function(loader,callback){"function"==typeof loader&&(callback=loader,loader=void 0),loader=global_loader_dom||document.querySelector(global_loader_className);var showLoader=function(){loader&&(loader.style.display="")},always_show_loader=global_always_show_loader===!0?!0:!1;always_show_loader&&showLoader(),always_show_loader||root.currentIsVisited||showLoader(),callback&&"function"==typeof callback&&callback()},loadingEndHandler=function(loader,callback){"function"==typeof loader&&(callback=loader,loader=void 0),loader=global_loader_dom||document.querySelector(global_loader_className);var hideLoader=function(){loader&&(loader.style.display="none")},done=!1;setTimeout(function(){done||(hideLoader(),callback&&"function"==typeof callback&&callback()),done=!0},96),void 0===global_loading_delay&&(global_loading_delay=3e3,avalon.illyWarning("no global_loading_delay set!")),setTimeout(function(){done||(hideLoader(),callback&&"function"==typeof callback&&callback(),avalon.illyRecord("time not enough to rendered page!")),done=!0},global_loading_delay)};root.$watch("currentAction",function(currentAction){"onBegin"===currentAction&&loadingBeginHandler(),"microsite"!==root.namespace&&"onLoad"===currentAction&&loadingEndHandler()}),root.$watch("currentRendered",function(rendered){rendered===!0&&loadingEndHandler()});var resetScrollbarWhenViewLoaded=function(){document.body.scrollTop=0,document.documentElement.scrollTop=0};global_always_reset_scrollbar===!0&&root.$watch("currentAction",function(currentAction){"onLoad"===currentAction&&resetScrollbarWhenViewLoaded()});var bindBadNetworkHandler=function(timeout){badNetworkTimer&&clearTimeout(badNetworkTimer),timeout=global_loading_timeout;var loader=global_loader_dom||document.querySelector(global_loader_className),badNetworkTimer=setTimeout(function(){alert("对不起，您的网络状态暂时不佳，请稍后重试！"),history.go(-1),loader&&(loader.style.display="none")},timeout);avalon.badNetworkTimer=badNetworkTimer},unbindBadNetworkHandler=function(timer){timer=timer||avalon.badNetworkTimer,timer&&clearTimeout(timer)};root.$watch("currentAction",function(currentAction){"onBegin"===currentAction&&bindBadNetworkHandler(),"onLoad"===currentAction&&unbindBadNetworkHandler()});var setPageTitle=function(titleMap){titleMap=titleMap||ACTIONBAR_TITLE_MAP;var currentState=root.currentState;root.title=titleMap[currentState]};root.$watch("currentAction",function(currentAction){"onLoad"===currentAction&&setPageTitle()});
//# sourceMappingURL=globalComponents.js.map