!function(gmu,$){var cssPrefix=$.fx.cssPrefix,transitionEnd=$.fx.transitionEnd;gmu.define("Panel",{options:{contentWrap:"",scrollMode:"follow",display:"push",position:"right",dismissible:!0,swipeClose:!0},_init:function(){var me=this,opts=me._options;me.on("ready",function(){me.displayFn=me._setDisplay(),me.$contentWrap.addClass("ui-panel-animate"),me.$el.on(transitionEnd,$.proxy(me._eventHandler,me)).hide(),opts.dismissible&&me.$panelMask.hide().on("click",$.proxy(me._eventHandler,me)),"follow"!==opts.scrollMode&&$(window).on("scrollStop",$.proxy(me._eventHandler,me)),$(window).on("ortchange",$.proxy(me._eventHandler,me))})},_create:function(){if(!this._options.setup)throw new Error("panel组件不支持create模式，请使用setup模式");var me=this,opts=me._options,$el=me.$el.addClass("ui-panel ui-panel-"+opts.position);me.panelWidth=$el.width()||0,me.$contentWrap=$(opts.contentWrap||$el.next()),opts.dismissible&&(me.$panelMask=$('<div class="ui-panel-dismiss"></div>').width(document.body.clientWidth-$el.width()).appendTo("body")||null)},_setDisplay:function(){var panelPos,contPos,me=this,$panel=me.$el,$contentWrap=me.$contentWrap,transform=cssPrefix+"transform",posData=me._transDisplayToPos(),obj={};return $.each(["push","overlay","reveal"],function(i,display){obj[display]=function(isOpen,pos,isClear){return panelPos=posData[display].panel,contPos=posData[display].cont,$panel.css(transform,"translate3d("+me._transDirectionToPos(pos,panelPos[isOpen])+"px,0,0)"),isClear||($contentWrap.css(transform,"translate3d("+me._transDirectionToPos(pos,contPos[isOpen])+"px,0,0)"),me.maskTimer=setTimeout(function(){me.$panelMask&&me.$panelMask.css(pos,$panel.width()).toggle(isOpen)},400)),me}}),obj},_initPanelPos:function(dis,pos){return this.displayFn[dis](0,pos,!0),this.$el.get(0).clientLeft,this},_transDirectionToPos:function(pos,val){return"left"===pos?val:-val},_transDisplayToPos:function(){var me=this,panelWidth=me.panelWidth;return{push:{panel:[-panelWidth,0],cont:[0,panelWidth]},overlay:{panel:[-panelWidth,0],cont:[0,0]},reveal:{panel:[0,0],cont:[0,panelWidth]}}},_setShow:function(isOpen,dis,pos){var me=this,opts=me._options,eventName=isOpen?"open":"close",beforeEvent=$.Event("before"+eventName),changed=isOpen!==me.state(),_eventBinder=isOpen?"on":"off",_eventHandler=isOpen?$.proxy(me._eventHandler,me):me._eventHandler,_dis=dis||opts.display,_pos=pos||opts.position;return me.trigger(beforeEvent,[dis,pos]),beforeEvent.isDefaultPrevented()?me:(changed&&(me._dealState(isOpen,_dis,_pos),me.displayFn[_dis](me.isOpen=Number(isOpen),_pos),opts.swipeClose&&me.$el[_eventBinder]($.camelCase("swipe-"+_pos),_eventHandler),opts.display=_dis,opts.position=_pos),me)},_dealState:function(isOpen,dis,pos){var me=this,opts=me._options,$panel=me.$el,$contentWrap=me.$contentWrap,addCls="ui-panel-"+dis+" ui-panel-"+pos,removeCls="ui-panel-"+opts.display+" ui-panel-"+opts.position+" ui-panel-animate";return isOpen&&($panel.removeClass(removeCls).addClass(addCls).show(),"fix"===opts.scrollMode&&$panel.css("top",$(window).scrollTop()),me._initPanelPos(dis,pos),"reveal"===dis?$contentWrap.addClass("ui-panel-contentWrap").on(transitionEnd,$.proxy(me._eventHandler,me)):($contentWrap.removeClass("ui-panel-contentWrap").off(transitionEnd,$.proxy(me._eventHandler,me)),$panel.addClass("ui-panel-animate")),me.$panelMask&&me.$panelMask.css({left:"auto",right:"auto",height:document.body.clientHeight})),me},_eventHandler:function(e){var me=this,opts=me._options,scrollMode=opts.scrollMode,eventName=me.state()?"open":"close";switch(e.type){case"click":case"swipeLeft":case"swipeRight":me.close();break;case"scrollStop":"fix"===scrollMode?me.$el.css("top",$(window).scrollTop()):me.close();break;case transitionEnd:me.trigger(eventName,[opts.display,opts.position]);break;case"ortchange":me.$panelMask&&me.$panelMask.css("height",document.body.clientHeight),"fix"===scrollMode&&me.$el.css("top",$(window).scrollTop())}},open:function(display,position){return this._setShow(!0,display,position)},close:function(){return this._setShow(!1)},toggle:function(display,position){return this[this.isOpen?"close":"open"](display,position)},state:function(){return!!this.isOpen},destroy:function(){return this.$panelMask&&this.$panelMask.off().remove(),this.maskTimer&&clearTimeout(this.maskTimer),this.$contentWrap.removeClass("ui-panel-animate"),$(window).off("scrollStop",this._eventHandler),$(window).off("ortchange",this._eventHandler),this.$super("destroy")}})}(gmu,gmu.$);
//# sourceMappingURL=panel.js.map