!function(gmu,$,undefined){gmu.define("Refresh",{options:{load:null,statechange:null},_init:function(){var me=this,opts=me._options;me.on("ready",function(){$.each(["up","down"],function(i,dir){var $elem=opts["$"+dir+"Elem"],elem=$elem.get(0);$elem.length&&(me._status(dir,!0),(!elem.childNodes.length||$elem.find(".ui-refresh-icon").length&&$elem.find(".ui-refresh-label").length)&&(!elem.childNodes.length&&me._createBtn(dir),opts.refreshInfo||(opts.refreshInfo={}),opts.refreshInfo[dir]={$icon:$elem.find(".ui-refresh-icon"),$label:$elem.find(".ui-refresh-label"),text:$elem.find(".ui-refresh-label").html()}),$elem.on("click",function(){me._status(dir)&&!opts._actDir&&(me._setStyle(dir,"loading"),me._loadingAction(dir,"click"))}))})}),me.on("destroy",function(){me.$el.remove()})},_create:function(){var me=this,opts=me._options,$el=me.$el;me._options.setup&&(opts.$upElem=$el.find(".ui-refresh-up"),opts.$downElem=$el.find(".ui-refresh-down"),$el.addClass("ui-refresh"))},_createBtn:function(dir){return this._options["$"+dir+"Elem"].html('<span class="ui-refresh-icon"></span><span class="ui-refresh-label">加载更多</span>'),this},_setStyle:function(dir,state){var me=this,stateChange=$.Event("statechange");return me.trigger(stateChange,me._options["$"+dir+"Elem"],state,dir),stateChange.defaultPrevented?me:me._changeStyle(dir,state)},_changeStyle:function(dir,state){var opts=this._options,refreshInfo=opts.refreshInfo[dir];switch(state){case"loaded":refreshInfo.$label.html(refreshInfo.text),refreshInfo.$icon.removeClass(),opts._actDir="";break;case"loading":refreshInfo.$label.html("加载中..."),refreshInfo.$icon.addClass("ui-loading"),opts._actDir=dir;break;case"disable":refreshInfo.$label.html("没有更多内容了")}return this},_loadingAction:function(dir,type){var me=this,opts=me._options,loadFn=opts.load;return $.isFunction(loadFn)&&loadFn.call(me,dir,type),me._status(dir,!1),me},afterDataLoading:function(dir){var me=this,dir=dir||me._options._actDir;return me._setStyle(dir,"loaded"),me._status(dir,!0),me},_status:function(dir,status){var opts=this._options;return status===undefined?opts["_"+dir+"Open"]:opts["_"+dir+"Open"]=!!status},_setable:function(able,dir,hide){var me=this,opts=me._options,dirArr=dir?[dir]:["up","down"];return $.each(dirArr,function(i,dir){var $elem=opts["$"+dir+"Elem"];$elem.length&&(able?$elem.show():hide?$elem.hide():me._setStyle(dir,"disable"),me._status(dir,able))}),me},disable:function(dir,hide){return this._setable(!1,dir,hide)},enable:function(dir){return this._setable(!0,dir)}})}(gmu,gmu.$);
//# sourceMappingURL=refresh.js.map