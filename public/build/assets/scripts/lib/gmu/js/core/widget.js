!function(gmu,$,undefined){function isPlainObject(obj){return"[object Object]"===toString.call(obj)}function eachObject(obj,iterator){obj&&Object.keys(obj).forEach(function(key){iterator(key,obj[key])})}function parseData(data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:/(?:\{[\s\S]*\}|\[[\s\S]*\])$/.test(data)?JSON.parse(data):data}catch(ex){data=undefined}return data}function getDomOptions(el){for(var key,data,ret={},attrs=el&&el.attributes,len=attrs&&attrs.length;len--;)data=attrs[len],key=data.name,"data-"===key.substring(0,5)&&(key=key.substring(5),data=parseData(data.value),data===undefined||(ret[key]=data));return ret}function zeptolize(name){var key=name.substring(0,1).toLowerCase()+name.substring(1),old=$.fn[key];$.fn[key]=function(opts){var ret,obj,args=slice.call(arguments,1),method="string"==typeof opts&&opts;return $.each(this,function(i,el){if(obj=record(el,name)||new gmu[name](el,isPlainObject(opts)?opts:undefined),"this"===method)return ret=obj,!1;if(method){if(!$.isFunction(obj[method]))throw new Error("组件没有此方法："+method);if(ret=obj[method].apply(obj,args),ret!==undefined&&ret!==obj)return!1;ret=undefined}}),ret!==undefined?ret:this},$.fn[key].noConflict=function(){return $.fn[key]=old,this}}function loadOption(klass,opts){var me=this;klass.superClass&&loadOption.call(me,klass.superClass,opts),eachObject(record(klass,"options"),function(key,option){option.forEach(function(item){var condition=item[0],fn=item[1];("*"===condition||$.isFunction(condition)&&condition.call(me,opts[key])||condition===opts[key])&&fn.call(me)})})}function loadPlugins(klass,opts){var me=this;klass.superClass&&loadPlugins.call(me,klass.superClass,opts),eachObject(record(klass,"plugins"),function(opt,plugin){opts[opt]!==!1&&(eachObject(plugin,function(key,val){var oringFn;me[key]=$.isFunction(val)&&(oringFn=me[key])?function(){var ret,origin=me.origin;return me.origin=oringFn,ret=val.apply(me,arguments),origin===undefined?delete me.origin:me.origin=origin,ret}:val}),plugin._init.call(me))})}function mergeObj(){for(var last,args=slice.call(arguments),i=args.length;i--;)last=last||args[i],isPlainObject(args[i])||args.splice(i,1);return args.length?$.extend.apply(null,[!0,{}].concat(args)):last}function bootstrap(name,klass,uid,el,options){var opts,me=this;return isPlainObject(el)&&(options=el,el=undefined),options&&options.el&&(el=$(options.el)),el&&(me.$el=$(el),el=me.$el[0]),opts=me._options=mergeObj(klass.options,getDomOptions(el),options),me.template=mergeObj(klass.template,opts.template),me.tpl2html=mergeObj(klass.tpl2html,opts.tpl2html),me.widgetName=name.toLowerCase(),me.eventNs="."+me.widgetName+uid,me._init(opts),me._options.setup=me.$el&&me.$el.parent()[0]?!0:!1,loadOption.call(me,klass,opts),loadPlugins.call(me,klass,opts),me._create(),me.trigger("ready"),el&&record(el,name,me)&&me.on("destroy",function(){record(el,name,null)}),me}function createClass(name,object,superClass){function klass(el,options){if("Base"===name)throw new Error("Base类不能直接实例化");return this instanceof klass?bootstrap.call(this,name,klass,uuid++,el,options):new klass(el,options)}"function"!=typeof superClass&&(superClass=gmu.Base);var uuid=1,suid=1;return $.extend(klass,{register:function(name,obj){var plugins=record(klass,"plugins")||record(klass,"plugins",{});return obj._init=obj._init||blankFn,plugins[name]=obj,klass},option:function(option,value,method){var options=record(klass,"options")||record(klass,"options",{});return options[option]||(options[option]=[]),options[option].push([value,method]),klass},inherits:function(obj){return createClass(name+"Sub"+suid++,obj,klass)},extend:function(obj){var proto=klass.prototype,superProto=superClass.prototype;staticlist.forEach(function(item){obj[item]=mergeObj(superClass[item],obj[item]),obj[item]&&(klass[item]=obj[item]),delete obj[item]}),eachObject(obj,function(key,val){proto[key]="function"==typeof val&&superProto[key]?function(){var ret,$super=this.$super;return this.$super=function(){var args=slice.call(arguments,1);return superProto[key].apply(this,args)},ret=val.apply(this,arguments),$super===undefined?delete this.$super:this.$super=$super,ret}:val})}}),klass.superClass=superClass,klass.prototype=Object.create(superClass.prototype),klass.extend(object),klass}var slice=[].slice,toString=Object.prototype.toString,blankFn=function(){},staticlist=["options","template","tpl2html"],record=function(){var data={},id=0,ikey="_gid";return function(obj,key,val){var dkey=obj[ikey]||(obj[ikey]=++id),store=data[dkey]||(data[dkey]={});return val!==undefined&&(store[key]=val),null===val&&delete store[key],store[key]}}(),event=gmu.event;gmu.define=function(name,object,superClass){gmu[name]=createClass(name,object,superClass),zeptolize(name)},gmu.isWidget=function(obj,klass){return klass="string"==typeof klass?gmu[klass]||blankFn:klass,klass=klass||gmu.Base,obj instanceof klass},gmu.Base=createClass("Base",{_init:blankFn,_create:blankFn,getEl:function(){return this.$el},on:event.on,one:event.one,off:event.off,trigger:function(name){var evt="string"==typeof name?new gmu.Event(name):name,args=[evt].concat(slice.call(arguments,1)),opEvent=this._options[evt.type],$el=this.getEl();return opEvent&&$.isFunction(opEvent)&&!1===opEvent.apply(this,args)&&(evt.stopPropagation(),evt.preventDefault()),event.trigger.apply(this,args),$el&&$el.triggerHandler(evt,(args.shift(),args)),this},tpl2html:function(subpart,data){var tpl=this.template;return tpl="string"==typeof subpart?tpl[subpart]:(data=subpart,tpl),data||~tpl.indexOf("<%")?$.parseTpl(tpl,data):tpl},destroy:function(){this.$el&&this.$el.off(this.eventNs),this.trigger("destroy"),this.off(),this.destroyed=!0}},Object),$.ui=gmu}(gmu,gmu.$);
//# sourceMappingURL=widget.js.map