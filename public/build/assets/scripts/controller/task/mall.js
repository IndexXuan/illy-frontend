define([],function(){var apiBaseUrl=avalon.illyGlobal.apiBaseUrl||"http://api.hizuoye.com/api/v1/",token=avalon.illyGlobal.token||localStorage.getItem("illy-token"),limit=6,mall=avalon.define({$id:"mall",visited:!1,lists:[],rules:"",offset:0,btnShowMore:!0,fetchRemoteData:function(apiArgs,data,target,type){$http.ajax({url:apiBaseUrl+apiArgs,headers:{Authorization:"Bearer "+token},data:data,success:function(res){mall[target]="concat"===type?mall[target].concat(res):res},error:function(res){avalon.log("mall ajax error when fetch data"+res)},ajaxFail:function(res){avalon.log("mall ajax failed when fetch data"+res)}})},showMore:function(e){e.preventDefault();var page=2;return mall.offset<limit?void(mall.btnShowMore=!1):(mall.offset=mall.offset+limit*(page-1),void mall.fetchRemoteData("score/mall",{offset:mall.offset},"lists","concat"))}});return avalon.controller(function($ctrl){$ctrl.$onBeforeUnload=function(){},$ctrl.$onEnter=function(){mall.visited=avalon.vmodels.root.currentIsVisited,mall.btnShowMore=mall.offset<=limit?!1:!0,mall.fetchRemoteData("score/mall",{},"lists"),mall.fetchRemoteData("score/exchangeInstruction",{},"rules")},$ctrl.$onRendered=function(){},$ctrl.$vmodels=[]})});
//# sourceMappingURL=mall.js.map